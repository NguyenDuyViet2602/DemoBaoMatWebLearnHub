import axios from 'axios';

const KEY = 'pentestMode';

export const getPentestMode = () => {
  const stored = typeof window !== 'undefined' ? localStorage.getItem(KEY) : null;
  return stored === 'vuln' ? 'vuln' : 'secure';
};

export const applyPentestMode = (mode) => {
  const value = mode === 'vuln' ? 'vuln' : 'secure';
  if (typeof window !== 'undefined') {
    localStorage.setItem(KEY, value);
  }
  axios.defaults.headers.common['X-Pentest-Mode'] = value;
  return value;
};

export const togglePentestMode = () => {
  const current = getPentestMode();
  const next = current === 'secure' ? 'vuln' : 'secure';
  return applyPentestMode(next);
};

